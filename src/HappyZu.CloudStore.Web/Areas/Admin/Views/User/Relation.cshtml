@{
    ViewBag.Title = "推广关系";
}
<!-- BEGIN PAGE BAR -->
<div class="page-bar">
    <ul class="page-breadcrumb">
        <li>
            <a href="@Url.Action("Index",new {controller="Dashboard"})">控制面板</a>
            <i class="fa fa-angle-right"></i>
        </li>
        <li>
            <span>@ViewBag.Title</span>
        </li>
    </ul>
</div>
<!-- END PAGE BAR -->
<!-- BEGIN PAGE TITLE-->
<h3 class="page-title">
    @ViewBag.Title
    <small>查询用户推荐关系</small>
</h3>
<!-- END PAGE TITLE-->
<!-- END PAGE HEADER-->


<div class="row">
    <div class="col-md-12">
        @*<div class="note note-danger">
                <p> NOTE: The below datatable is not connected to a real database so the filter and sorting is just simulated for demo purposes only. </p>
            </div>*@
        <!-- Begin: life time stats -->
        <div class="portlet light portlet-fit portlet-datatable bordered">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-settings font-dark"></i>
                    <span class="caption-subject font-dark sbold uppercase">@ViewBag.Title</span>
                </div>
                <div class="actions">
                    <input class="form-control input-inline input-circle input-sm" type="text" name="UserName" placeholder="用户名" />
                    <div class="btn-group btn-group-devided">
                        <a class="btn btn-transparent green btn-outline btn-circle btn-sm active" href="javascript:;"><i class="fa fa-search"></i> 查询子集</a>
                    </div>
                </div>
            </div>
            <div class="portlet-body">
                <div id="relationsTree" class="relations-tree"></div>
            </div>
        </div>
        <!-- End: life time stats -->
    </div>
</div>

@section style_plugins{
    <link href="~/Areas/Admin/content/global/plugins/jstree/dist/themes/default-dark/style.min.css" rel="stylesheet" />
}
@section script_plugins{
    <script src="~/Areas/Admin/content/global/plugins/jstree/dist/jstree.min.js" type="text/javascript"></script>
}
@section scripts{

    <!-- BEGIN PAGE LEVEL SCRIPTS -->
    <script>
    $(function () {
            $.ajax({ cache: false });

            $.jstree.destroy();
            $('#relationsTree').jstree({
                'core': {
                    'data': {
                        'url': '@Url.Action("GetCategorys", new { controller = "Product" })',
                        'data': function (node) {
                            return node.id === '#' ? { 'id': 0} : { 'id': node.id };
                        }
                    }
                },
                plugins: ["contextmenu", "dnd", "state", "types", "wholerow"],
                "contextmenu": {
                    "items": {
                        "create": null,
                        "rename": null,
                        "remove": null,
                        "ccp": null,
                        "add": {
                            "label": "编辑",
                            "action": function (obj) {
                                var inst = jQuery.jstree.reference(obj.reference);
                                var clickedNode = inst.get_node(obj.reference);
                                window.location.href = '@Url.Action("CategoryEdit", new { controller="Product"})/' + clickedNode.id;
                            }
                        },
                        "delete": {
                            "label": "删除",
                            "action": function (obj) {
                                var inst = jQuery.jstree.reference(obj.reference);
                                var clickedNode = inst.get_node(obj.reference);
                                alert("目前不允许删除 id is:" + clickedNode.id);
                            }
                        }
                    }
                }
            });
        })
    </script>
    <!-- END PAGE LEVEL SCRIPTS -->
}